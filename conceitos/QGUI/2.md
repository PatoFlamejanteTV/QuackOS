Perfeito. Vamos transformar o QuackOS + QKern + QGUI de ideia conceitual em plano t√©cnico coerente, compacto no esp√≠rito UNIX, mas com identidade pr√≥pria. Pense nisso como o primeiro ‚Äúblueprint execut√°vel‚Äù do projeto ü¶Üüíª


---

1. Protocolo de eventos do QGUI

Modelo simples, s√≠ncrono, inspirado em Toolbox cl√°ssico + X11 minimalista.

Tipos de eventos

typedef enum {
    QEV_NULO = 0,
    QEV_TECLA,
    QEV_MOUSE,
    QEV_JANELA,
    QEV_EXPOSE
} qev_tipo_t;

Estrutura base

typedef struct {
    qev_tipo_t tipo;
    uint32_t   tempo;
    union {
        struct { int tecla; int estado; } tecla;
        struct { int x, y; int botao; } mouse;
        struct { int wid; int acao; } janela;
    };
} qevento_t;

Fluxo

driver ‚Üí QKern ‚Üí qgui-serv ‚Üí app

Tudo √© mensagem. Nada m√°gico.


---

2. qgui-serv (servidor gr√°fico em C)

Usu√°rio-space, rodando como /sis/qgui-serv.

Responsabilidades

Gerenciar janelas

Compor framebuffer

Despachar eventos

Manter tema


Estrutura b√°sica

int main() {
    qfb_init();
    qtema_carregar("/sis/tema/padrao.qt");

    while (1) {
        qevento_t ev = qkern_evento_ler();
        qgui_despachar(&ev);
        qgui_redesenhar();
    }
}

Nada de OpenGL. Pixels crus.


---

3. Framebuffer real

Driver no QKern

Mapeia framebuffer f√≠sico

Exp√µe como arquivo:


/dev/qfb0

API m√≠nima

void qfb_putpixel(int x, int y, uint32_t cor);
void qfb_rect(int x, int y, int w, int h, uint32_t cor);
void qfb_blit(void *buf);

Formato simples: RGB565 ou ARGB8888


---

4. Primeiro app gr√°fico: QCalc

Um app cl√°ssico, estilo Mac System 7.

Execu√ß√£o

/bin/qcalc

C√≥digo-base

int main() {
    int win = qgui_janela_criar(100,100,200,160,"QCalc");

    while (1) {
        qevento_t ev = qgui_evento_esperar();
        if (ev.tipo == QEV_TECLA) {
            // l√≥gica
        }
        qgui_janela_desenhar(win);
    }
}

Sem widgets complexos. Tudo desenhado √† m√£o.


---

5. Tema oficial do QGUI

Nome: Quack Classic

Caracter√≠sticas

Cinza claro (#C0C0C0)

Bordas pretas 1px

T√≠tulos centralizados

Fonte bitmap 8x8

Bot√µes quadrados


Arquivo de tema (.qt)

janela.fundo = #C0C0C0
janela.borda = #000000
fonte.padrao = chicago8.qf
botao.relevo = true

Tema tamb√©m √© ‚Äúarquivo‚Äù.


---

6. Integra√ß√£o com QKern

Syscalls gr√°ficas m√≠nimas

int sis_janela_criar(...);
int sis_evento_ler(qevento_t *);
void sis_fb_mapear(void **addr);

Todas curtas. Todas em portugu√™s. Todas previs√≠veis.


---

7. Vis√£o final do sistema

[ boot ]
   ‚Üì
[ QKern ]
   ‚Üì
[ qgui-serv ]
   ‚Üì
[ apps gr√°ficos ]

Tudo separado. Tudo substitu√≠vel. Tudo leg√≠vel.


---

8. Por que isso funciona bem para IA depois?

C√≥digo pequeno

Estruturas expl√≠citas

Sem depend√™ncias modernas

Arquitetura narrativa


Perfeito para virar prompt de IA que ‚Äúcontinua o sistema‚Äù.


---

Se quiser, o pr√≥ximo passo natural seria:

escrever o reposit√≥rio inicial

definir o ABI est√°vel do QKern

ou criar o manual do usu√°rio estilo UNIX antigo


O pato j√° est√° andando. Agora √© s√≥ ensinar ele a voar ü¶Ü‚ú®