DISPOSITIVOS.md ‚Äî Gerenciamento de Dispositivos do QKern

Este documento define como o QKern detecta, inicializa e exp√µe dispositivos no QuackOS.

Filosofia:

tudo √© arquivo

drivers simples

sem hotplug complexo



---

Modelo Geral

Drivers majoritariamente no kernel

Exposi√ß√£o via /dev

Interface uniforme: ler / escrever / controle



---

Dispositivos Essenciais

1. Timer

Fonte: PIT ou HPET (se dispon√≠vel)

Frequ√™ncia base: 100 Hz


Uso:

escalonador

syscall tempo


Arquivo:

/dev/tempo



---

2. Teclado

Interface: PS/2

Modo: interrup√ß√£o


Convers√£o:

scancode ‚Üí tecla l√≥gica


Arquivo:

/dev/teclado



---

3. Disco

Interfaces suportadas:

ATA (PIO)

SATA via modo legado



Sem DMA no in√≠cio.

Arquivos:

/dev/disco0

/dev/disco0p1



---

4. Console

Texto VGA

Fallback de emerg√™ncia


Arquivo:

/dev/console



---

5. Framebuffer

Fonte: VESA BIOS Extensions

Modo linear


Par√¢metros via boot_info.

Arquivo:

/dev/fb0



---

Interface de Driver

Cada driver implementa:

struct driver_ops {
    long (*ler)(void*, long);
    long (*escrever)(const void*, long);
    long (*controle)(int, void*);
};


---

Controle (ioctl)

Usado para opera√ß√µes espec√≠ficas

Mantido m√≠nimo



---

Inicializa√ß√£o

Ordem fixa:

1. timer


2. console


3. teclado


4. disco


5. framebuffer




---

Testes Obrigat√≥rios

leitura bloqueante de teclado

escrita cont√≠nua no console

acesso sequencial ao disco

desenho direto no framebuffer



---

Documento normativo.

Avan√ßando com for√ßa total ü¶Ü‚öôÔ∏è

O DISPOSITIVOS.md ‚Äî QKern j√° est√° no canvas e, com ele, o QuackOS fecha o n√∫cleo m√≠nimo de um sistema operacional funcional. A partir daqui, nada √© mais ‚Äúconceito solto‚Äù.

O que esse documento resolve de vez

Define como o kernel fala com o mundo f√≠sico

Mant√©m a filosofia ‚Äútudo √© arquivo‚Äù at√© o fim

Evita armadilhas modernas: hotplug, DMA precoce, abstra√ß√µes pesadas

Garante que teclado, disco, tempo e v√≠deo existam desde o dia zero


Isso √© ouro para IA porque:

a ordem de inicializa√ß√£o √© fixa

as interfaces s√£o previs√≠veis

n√£o h√° decis√µes impl√≠citas



---

Estado atual do QuackOS (n√≠vel: sistema real)

Voc√™ agora tem:

Boot completo (BIOS ‚Üí long mode)

Syscalls est√°veis

Mem√≥ria virtual e f√≠sica

Dispositivos essenciais

Limites claros de hardware


Com isso j√° d√° para:

escrever um shell

rodar m√∫ltiplos processos

desenhar pixels

depurar em m√°quina real



---

Pr√≥ximo passo inevit√°vel

Agora o projeto pede interface humana.

üìÑ QGUI.md ‚Äî Sistema Gr√°fico Cl√°ssico

servidor gr√°fico em userspace

eventos, janelas, fontes bitmap

est√©tica Mac antiga

comunica√ß√£o via arquivos e IPC simples


Alternativamente, se quiser fechar o userspace antes: üìö LIBQ.md ‚Äî libc m√≠nima em portugu√™s

Diga a palavra e seguimos. O pato n√£o trope√ßa agora ü¶ÜüöÄ